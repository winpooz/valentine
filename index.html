<!DOCTYPE html>
<html>
<head>
<title>Dominick Valentine Quest</title>

<style>
* { margin:0; padding:0; }
body {
  overflow:hidden;
  background:black;
  font-family: monospace;
}

canvas {
  image-rendering: pixelated;
  display:block;
}

#dialogue {
  position: fixed;
  bottom: 10px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.7);
  color: white;
  padding: 12px 20px;
  font-size: 20px;
  border: 3px solid white;
}

.heart, .confetti, .firework {
  position: fixed;
  font-size: 24px;
  pointer-events:none;
}
</style>
</head>

<body>

<canvas id="game"></canvas>
<div id="dialogue">Use A / D or ‚Üê ‚Üí to walk üíï</div>

<audio id="music" loop>
  <source src="music.mp3">
</audio>

<audio id="xp">
  <source src="xp.mp3">
</audio>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resize();
window.onresize = resize;

// music
const music = document.getElementById("music");
music.volume = 0.3;
music.play();

let x = 100;
let step = 0;
const messages = [
  "Dominick spawned in a beautiful world...",
  "The sky is pink, the trees bloom for love üå∏",
  "Someone built this world just for you...",
  "You walk toward a glowing portal...",
  "He has something important to ask...",
  "Will you be my Valentine, Dominick? üíò"
];

let keys = {};
document.addEventListener("keydown", e => keys[e.key]=true);
document.addEventListener("keyup", e => keys[e.key]=false);

// pixel block
function block(px, py, size, color){
  ctx.fillStyle=color;
  ctx.fillRect(px,py,size,size);
}

// sunset sky
function sky() {
  const grad = ctx.createLinearGradient(0,0,0,canvas.height);
  grad.addColorStop(0,"#ff9a9e");
  grad.addColorStop(1,"#fad0c4");
  ctx.fillStyle = grad;
  ctx.fillRect(0,0,canvas.width,canvas.height);
}

// sakura tree
function sakura(px){
  for(let y=0;y<6;y++){
    for(let x=0;x<4;x++){
      block(px+x*16, canvas.height-300+y*16,16,"#ffb7c5");
    }
  }
  for(let y=0;y<4;y++){
    block(px+24, canvas.height-236+y*16,16,"#8B4513");
  }
}

// ground
function ground(){
  for(let i=0;i<canvas.width/16;i++){
    block(i*16, canvas.height-80,16,"#3CB043");
    block(i*16, canvas.height-64,16,"#8B4513");
    block(i*16, canvas.height-48,16,"#8B4513");
  }
}

// Dominick avatar
function player(){
  // afro
  ctx.fillStyle="#2b1a10";
  ctx.fillRect(x, canvas.height-180, 48, 32);

  // head
  ctx.fillStyle="#8d5524";
  ctx.fillRect(x, canvas.height-148, 48, 48);

  // eyes
  ctx.fillStyle="black";
  ctx.fillRect(x+12, canvas.height-120,6,6);
  ctx.fillRect(x+30, canvas.height-120,6,6);

  // dress
  ctx.fillStyle="#ff69b4";
  ctx.fillRect(x, canvas.height-100, 48, 48);

  // legs
  ctx.fillStyle="#0000ff";
  ctx.fillRect(x+6, canvas.height-52,12,32);
  ctx.fillRect(x+30, canvas.height-52,12,32);
}

function draw(){
  sky();
  ground();
  for(let i=0;i<8;i++){
    sakura(i*250+200);
  }
  player();
}

function update(){
  if(keys["a"] || keys["ArrowLeft"]) x -= 4;
  if(keys["d"] || keys["ArrowRight"]) x += 4;

  if(x > canvas.width - 200 && step < messages.length-1){
    step++;
    document.getElementById("dialogue").innerText = messages[step];
  }

  if(step === messages.length-1){
    endScene();
    return;
  }

  draw();
  requestAnimationFrame(update);
}
update();


// üéÜ END SCENE
function endScene(){
  document.body.innerHTML = `
  <style>
  body{background:black;color:white;text-align:center;font-size:40px;}
  button{font-size:30px;padding:15px;margin:20px;}
  </style>

  <h1>üíñ Will you be my Valentine, Dominick? üíñ</h1>
  <button onclick="yes()">YES üíï</button>
  <button onmouseover="this.style.position='absolute';this.style.left=Math.random()*80+'vw';this.style.top=Math.random()*80+'vh';">NO üòà</button>
  `;

  // floating hearts
  setInterval(()=>{
    let h=document.createElement("div");
    h.className="heart";
    h.innerHTML="üíó";
    h.style.left=Math.random()*100+"vw";
    h.style.bottom="-50px";
    h.style.fontSize=(20+Math.random()*30)+"px";
    h.style.animation="float 4s linear forwards";
    document.body.appendChild(h);
    setTimeout(()=>h.remove(),4000);
  },200);

  const style=document.createElement("style");
  style.innerHTML="@keyframes float{to{bottom:110vh;}}";
  document.head.appendChild(style);
}

// YES celebration
function yes(){
  document.getElementById("xp").play();

  // confetti
  for(let i=0;i<200;i++){
    let c=document.createElement("div");
    c.className="confetti";
    c.innerHTML="üéâ";
    c.style.left=Math.random()*100+"vw";
    c.style.top="-50px";
    c.style.animation="fall "+(2+Math.random()*3)+"s linear forwards";
    document.body.appendChild(c);
    setTimeout(()=>c.remove(),5000);
  }

  // fireworks
  for(let i=0;i<20;i++){
    setTimeout(()=>firework(), i*200);
  }

  alert("SHE SAID YES!!! üíï");
}

// confetti animation
const confStyle=document.createElement("style");
confStyle.innerHTML="@keyframes fall{to{top:110vh;}}";
document.head.appendChild(confStyle);

// fireworks effect
function firework(){
  let f=document.createElement("div");
  f.className="firework";
  f.innerHTML="‚ú®";
  f.style.left=Math.random()*100+"vw";
  f.style.top=Math.random()*50+"vh";
  f.style.fontSiz
